<app-banner></app-banner>

<div class="min-h-screen p-5">
  <!-- Hero Section with Enhanced Grid and Visual Appeal -->
  <div
    class="bg-gradient-to-r from-blue-50 to-yellow-50 py-20 relative overflow-hidden"
  >
    <!-- Background pattern -->
    <div class="absolute inset-0 opacity-10">
      <div
        class="absolute -top-24 -left-24 w-96 h-96 rounded-full bg-orange-300"
      ></div>
      <div
        class="absolute top-1/2 right-10 w-64 h-64 rounded-full bg-red-300"
      ></div>
      <div
        class="absolute bottom-10 left-1/3 w-40 h-40 rounded-full bg-blue-300"
      ></div>
    </div>

    <div class="container mx-auto px-6 relative z-10">
      <div class="flex flex-col lg:flex-row items-center gap-12">
        <div class="w-full lg:w-1/2 space-y-6">
          <h1
            class="text-4xl md:text-5xl lg:text-6xl font-bold text-gray-800 leading-tight"
          >
            Welcome to <span class="text-orange-500">L&B Pet Service</span>
          </h1>
          <p class="text-xl text-gray-600 max-w-lg">
            Your one-stop solution for all pet care needs in Malaysia
          </p>
          <div class="flex flex-wrap gap-4 pt-4">
            <a
              routerLink="/jobs"
              class="bg-red-500 text-white px-8 py-4 rounded-xl hover:bg-red-600 transition-all font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-1"
            >
              Find Services
            </a>
            <a
              routerLink="/market"
              class="bg-blue-500 text-white px-8 py-4 rounded-xl hover:bg-blue-600 transition-all font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-1"
            >
              Community Market
            </a>
          </div>
        </div>
        <div class="w-full lg:w-1/2">
          <img
            src="assets/images/hero-pets.jpg"
            alt="Happy pets"
            class="rounded-2xl shadow-2xl mx-auto w-full object-cover max-h-96 transform hover:scale-[1.02] transition-transform duration-300"
            onerror="this.src='https://images.unsplash.com/photo-1450778869180-41d0601e046e?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8MHx8fHx8&auto=format&fit=crop&w=1050&q=80'"
          />
        </div>
      </div>
    </div>
  </div>

  <!-- About Us Section -->
  <section id="about" class="py-16 bg-white">
    <div class="container mx-auto px-4">
      <h2 class="text-3xl font-bold text-center mb-12 text-gray-800">
        About Us
      </h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
        <div>
          <h3 class="text-2xl font-semibold mb-4 text-gray-800">
            L&B Pet Service
          </h3>
          <p class="text-gray-600 mb-4">
            In Malaysia, pet owners face numerous challenges in caring for their
            beloved animals. From lack of time for pet walks to uncertainty
            about appropriate products, and concerns about leaving pets alone at
            home.
          </p>
          <p class="text-gray-600 mb-4">
            L&B Pet Service is born from these challenges, offering a
            comprehensive platform that connects pet owners with reliable pet
            care services and creates a marketplace for new and secondhand pet
            accessories.
          </p>
          <div class="grid grid-cols-2 gap-4 mt-6">
            <div
              class="bg-blue-50 p-4 rounded-lg transform hover:scale-[1.02] transition-transform duration-300"
            >
              <div class="text-blue-500 text-2xl mb-2">
                <i class="fas fa-paw"></i>
              </div>
              <h4 class="font-medium text-lg">Pet Sitting</h4>
              <p class="text-sm text-gray-600">
                Professional pet sitting and walking services
              </p>
            </div>
            <div
              class="bg-green-50 p-4 rounded-lg transform hover:scale-[1.02] transition-transform duration-300"
            >
              <div class="text-green-500 text-2xl mb-2">
                <i class="fas fa-exchange-alt"></i>
              </div>
              <h4 class="font-medium text-lg">Marketplace</h4>
              <p class="text-sm text-gray-600">
                Buy and sell secondhand pet accessories
              </p>
            </div>
            <div
              class="bg-yellow-50 p-4 rounded-lg transform hover:scale-[1.02] transition-transform duration-300"
            >
              <div class="text-yellow-500 text-2xl mb-2">
                <i class="fas fa-shopping-bag"></i>
              </div>
              <h4 class="font-medium text-lg">Pet Shop</h4>
              <p class="text-sm text-gray-600">
                Quality products for your pets
              </p>
            </div>
            <div
              class="bg-purple-50 p-4 rounded-lg transform hover:scale-[1.02] transition-transform duration-300"
            >
              <div class="text-purple-500 text-2xl mb-2">
                <i class="fas fa-users"></i>
              </div>
              <h4 class="font-medium text-lg">Community</h4>
              <p class="text-sm text-gray-600">Connect with other pet lovers</p>
            </div>
          </div>
        </div>
        <div>
          <img
            src="assets/images/about-pets.jpg"
            alt="Happy pets with owners"
            class="rounded-lg shadow-lg w-full h-64 md:h-122 object-cover transform hover:scale-[1.02] transition-transform duration-300"
            onerror="this.src='https://images.unsplash.com/photo-1560807707-8cc77767d783?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8MHx8fHx8&auto=format&fit=crop&w=1050&q=80'"
          />
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Services Section -->
  <section class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
      <div class="flex justify-between items-center mb-10">
        <h2 class="text-3xl font-bold text-gray-800">Featured Services</h2>
        <a
          routerLink="/jobs"
          class="text-red-500 hover:text-red-700 font-medium flex items-center"
        >
          View all services
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 ml-1"
            viewBox="0 0 20 20"
            fill="currentColor"
          >
            <path
              fill-rule="evenodd"
              d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z"
              clip-rule="evenodd"
            />
          </svg>
        </a>
      </div>

      <div *ngIf="isServicesLoading" class="text-center py-12">
        <div
          class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500 mx-auto"
        ></div>
        <p class="text-gray-600 mt-4">Loading services...</p>
      </div>

      <div *ngIf="!isServicesLoading && serviceError" class="text-center py-12">
        <p class="text-red-500">{{ serviceError }}</p>
        <button
          (click)="loadFeaturedServices()"
          class="mt-4 bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600"
        >
          Try Again
        </button>
      </div>

      <div
        *ngIf="!isServicesLoading && !serviceError"
        class="grid grid-cols-1 md:grid-cols-3 gap-6"
      >
        <div
          *ngFor="let service of featuredServices"
          class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 border-orange-300 border-2 border-dashed hover:border-solid hover:border-orange-400 flex flex-col h-full"
        >
          <div class="p-6 flex-grow">
            <div class="flex justify-between items-start mb-4">
              <div>
                <span
                  class="bg-blue-100 text-blue-800 text-xs font-medium px-3 py-1 rounded-full"
                >
                  {{ service.category }}
                </span>
                <h3 class="text-xl font-semibold text-gray-800 mt-2">
                  {{ service.title }}
                </h3>
              </div>
              <div
                class="bg-red-50 text-red-700 font-bold px-4 py-1.5 rounded-lg"
              >
                RM{{ service.hourRate }}/hr
              </div>
            </div>

            <div class="flex items-center text-gray-500 text-sm mb-4">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4 mr-1"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                />
              </svg>
              {{ service.address }}
            </div>

            <div class="grid grid-cols-2 gap-4 text-sm mb-4">
              <div class="bg-gray-50 p-3 rounded-lg">
                <p class="text-gray-600 text-xs">Pet Owner</p>
                <p class="font-medium">{{ service.ownerName }}</p>
              </div>
              <div class="bg-gray-50 p-3 rounded-lg">
                <p class="text-gray-600 text-xs">Pet Type</p>
                <p class="font-medium">{{ service.petType }}</p>
              </div>
            </div>

            <div
              *ngIf="service.note"
              class="text-sm text-gray-600 mb-4 bg-yellow-50 p-3 rounded-lg italic"
            >
              "{{ service.note }}"
            </div>
          </div>

          <div class="p-6 pt-0 mt-auto">
            <a
              *ngIf="service.userEmail !== userEmail"
              href="https://wa.me/{{ service.phoneNumber }}"
              class="block text-center bg-red-500 text-white py-3 px-4 rounded-xl hover:bg-red-600 transition-colors shadow-md hover:shadow-lg transform hover:-translate-y-0.5"
            >
              Contact Pet Owner
            </a>
            <a
              *ngIf="service.userEmail === userEmail"
              (click)="navigateToProfileServiceListings($event)"
              class="block text-center bg-blue-500 text-white py-3 px-4 rounded-xl hover:bg-blue-600 transition-colors shadow-md hover:shadow-lg transform hover:-translate-y-0.5 cursor-pointer"
            >
              Manage Your Listings
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Community Market Section -->
  <section class="py-16 bg-white">
    <div class="container mx-auto px-4">
      <div class="flex justify-between items-center mb-10">
        <h2 class="text-3xl font-bold text-gray-800">Community Market</h2>
        <a
          (click)="navigateToCommunityMarket()"
          class="text-red-500 hover:text-red-700 font-medium flex items-center cursor-pointer"
        >
          Browse marketplace
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 ml-1"
            viewBox="0 0 20 20"
            fill="currentColor"
          >
            <path
              fill-rule="evenodd"
              d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z"
              clip-rule="evenodd"
            />
          </svg>
        </a>
      </div>

      <div *ngIf="isMarketLoading" class="text-center py-12">
        <div
          class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500 mx-auto"
        ></div>
        <p class="text-gray-600 mt-4">Loading market items...</p>
      </div>

      <div *ngIf="!isMarketLoading && marketError" class="text-center py-12">
        <p class="text-red-500">{{ marketError }}</p>
        <button
          (click)="loadFeaturedMarketItems()"
          class="mt-4 bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600"
        >
          Try Again
        </button>
      </div>

      <div
        *ngIf="!isMarketLoading && !marketError"
        class="grid grid-cols-2 md:grid-cols-4 gap-6"
      >
        <div
          *ngFor="let item of featuredMarketItems"
          class="bg-white rounded-xl overflow-hidden border-orange-300 border-2 border-dashed hover:border-solid hover:border-orange-400 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 flex flex-col h-full cursor-pointer"
        >
          <!-- Product Image -->
          <div
            class="relative overflow-hidden"
            (click)="viewProductDetails(item)"
          >
            <img
              [src]="
                item.productImg && item.productImg.length
                  ? item.productImg[0]
                  : ''
              "
              [alt]="item.productTitle"
              class="w-full h-48 object-cover hover:scale-105 transition-transform duration-300"
            />
          </div>

          <!-- Product Info -->
          <div class="p-5 flex-grow" (click)="viewProductDetails(item)">
            <span
              class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-1 rounded-full mb-2 inline-block"
            >
              {{ item.category }}
              <span *ngIf="item.subCategory">- {{ item.subCategory }}</span>
            </span>

            <h3 class="text-lg font-semibold text-gray-800 mb-2 line-clamp-2">
              {{ item.productTitle }}
            </h3>

            <p class="text-red-600 font-bold text-lg">
              RM{{ item.productPrice }}
            </p>
            <p class="text-gray-600">{{ item.condition }}</p>

            <p
              *ngIf="item.productQuantity > 0"
              class="text-gray-600 text-sm mb-3"
            >
              Quantity: {{ item.productQuantity }}
            </p>

            <div class="flex items-center text-xs text-gray-500 mb-1">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-3 w-3 mr-1"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                />
              </svg>
              <span *ngIf="item.username">{{ item.username }}</span>

              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-3 w-3 ml-2 mr-1"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                />
              </svg>
              <span *ngIf="item.createdAt">{{
                calculateTimeAgo(item.createdAt)
              }}</span>
            </div>
          </div>

          <!-- Action Button -->
          <div class="p-5 pt-0 mt-auto">
            <button
              *ngIf="item.userEmail === userEmail"
              (click)="editMarketItem(item, $event)"
              class="w-full text-center bg-blue-500 text-white py-2.5 px-4 rounded-xl hover:bg-blue-600 transition-all shadow-md hover:shadow-lg transform hover:-translate-y-0.5 flex items-center justify-center gap-2 cursor-pointer"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                />
              </svg>
              Edit Item
            </button>

            <button
              *ngIf="item.userEmail !== userEmail"
              (click)="addMarketItemToCart(item, $event)"
              class="w-full text-center bg-red-500 text-white py-2.5 px-4 rounded-xl hover:bg-red-600 transition-all shadow-md hover:shadow-lg transform hover:-translate-y-0.5 flex items-center justify-center gap-2 cursor-pointer"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"
                />
              </svg>
              Add to Cart
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Shop Products Section -->
  <section class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
      <div class="flex justify-between items-center mb-10">
        <h2 class="text-3xl font-bold text-gray-800">Pet Shop</h2>
        <a
          (click)="navigateToShop()"
          class="text-red-500 hover:text-red-700 font-medium flex items-center cursor-pointer"
        >
          Visit shop
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 ml-1"
            viewBox="0 0 20 20"
            fill="currentColor"
          >
            <path
              fill-rule="evenodd"
              d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z"
              clip-rule="evenodd"
            />
          </svg>
        </a>
      </div>

      <div *ngIf="isShopLoading" class="text-center py-12">
        <div
          class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500 mx-auto"
        ></div>
        <p class="text-gray-600 mt-4">Loading shop products...</p>
      </div>

      <div *ngIf="!isShopLoading && shopError" class="text-center py-12">
        <p class="text-red-500">{{ shopError }}</p>
        <button
          (click)="loadFeaturedShopItems()"
          class="mt-4 bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600"
        >
          Try Again
        </button>
      </div>

      <div
        *ngIf="!isShopLoading && !shopError"
        class="grid grid-cols-2 md:grid-cols-4 gap-6"
      >
        <div
          *ngFor="let product of featuredShopItems"
          class="bg-white rounded-xl overflow-hidden border-orange-300 border-2 border-dashed hover:border-solid hover:border-orange-400 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 flex flex-col h-full cursor-pointer"
        >
          <div
            class="relative overflow-hidden"
            (click)="viewShopProductDetails(product)"
          >
            <img
              [src]="
                product.productImg && product.productImg.length
                  ? product.productImg[0]
                  : 'assets/images/no-product-image.jpg'
              "
              [alt]="product.productTitle"
              class="w-full h-48 object-contain bg-white p-2 hover:scale-105 transition-all duration-300"
              onerror="this.src='https://via.placeholder.com/300x200?text=No+Image'"
            />

            <!-- Badge for product brand or special offer -->
            <div class="absolute top-2 left-2">
              <span
                class="bg-blue-500 text-white text-xs px-2 py-1 rounded-full font-medium"
              >
                {{ product.productBrand || product.category }}
              </span>
            </div>
          </div>

          <div class="p-5 flex-grow" (click)="viewShopProductDetails(product)">
            <span class="text-xs text-gray-500 block mb-1">
              {{ product.category }}
            </span>
            <h3 class="text-lg font-semibold text-gray-800 mb-2 line-clamp-2">
              {{ product.productTitle }}
            </h3>
            <div class="flex items-center mb-2">
              <p class="text-red-600 font-bold text-lg">
                RM{{ formatPrice(product.productPrice) }}
              </p>
            </div>

            <div class="flex space-x-2">
              <span
                class="inline-block bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded"
              >
                Quantity: {{ product.productQuantity }}
              </span>
            </div>
          </div>

          <div class="p-5 pt-0 mt-auto">
            <button
              class="w-full text-center bg-red-500 text-white py-2.5 px-4 rounded-xl hover:bg-red-600 transition-all shadow-md hover:shadow-lg transform hover:-translate-y-0.5 flex items-center justify-center gap-2 cursor-pointer"
              (click)="addToCart(product, $event)"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"
                />
              </svg>
              Add to Cart
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section
    class="py-20 bg-gradient-to-r from-orange-400 to-orange-300 text-white relative overflow-hidden"
  >
    <!-- Background elements -->
    <div class="absolute inset-0 overflow-hidden opacity-10">
      <div
        class="absolute -top-10 -right-10 w-64 h-64 rounded-full bg-white"
      ></div>
      <div
        class="absolute bottom-10 left-1/4 w-32 h-32 rounded-full bg-white"
      ></div>
      <div
        class="absolute top-1/4 left-10 w-24 h-24 rounded-full bg-white"
      ></div>
      <svg
        class="absolute bottom-0 right-0 w-64 h-64 text-white opacity-20"
        viewBox="0 0 24 24"
        fill="currentColor"
      >
        <path
          d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm0 5c3.866 0 7 3.134 7 7s-3.134 7-7-7-7-3.134-7-7z"
        ></path>
      </svg>
    </div>

    <div class="container mx-auto px-6 relative z-10">
      <div class="max-w-3xl mx-auto text-center">
        <h2 class="text-4xl md:text-5xl font-bold mb-6 drop-shadow">
          Join Our Pet-Loving Community Today!
        </h2>
        <p class="text-xl mb-10 max-w-2xl mx-auto opacity-90">
          Connect with other pet owners, find services for your furry friends,
          and explore our marketplace for all your pet needs.
        </p>
        <div class="flex flex-wrap justify-center gap-6">
          <a
            (click)="handleSignupClick($event)"
            class="bg-white text-orange-600 px-8 py-4 rounded-xl hover:bg-gray-100 transition-all font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-1 cursor-pointer"
          >
            Sign Up Now
          </a>
          <a
            routerLink="/forum"
            class="bg-transparent border-2 border-white text-white px-8 py-4 rounded-xl hover:bg-white hover:text-orange-600 transition-all font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-1"
          >
            Join Forum
          </a>
        </div>
      </div>
    </div>
  </section>
</div>
